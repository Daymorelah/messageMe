language: node_js
node_js:
  - "node"
#Select branch to test
branches:
  only:
    - test
#Select how to get notified if a test was conducted and if it passed or failed
notifications:
  email:
    on_success: change
    on_failure: change
# Determine what command to run on the console
before_script:
  - psql -c 'CREATE DATABASE test2;' -U postgres
  - npm run migration
# Select service to use (database to use)
services:
  - postgresql
# Choose what command to use to run the test
script:
  - npm test
# Choose what enviroment to use to test
env:
  - NODE_ENV=test
# Adddon necessary so as to be able to run migrations
after_success:
  - npm run coveralls
  - npm install -g codeclimate-test-reporter
  - CODECLIMATE_REPO_TOKEN=b4aa32a6ec29dae9989c38b9e6775cbd33bb95733c059431f0353ea2493552e3 codeclimate-test-reporter < ./coverage/lcov.info
